<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph Debugger Help</title>

  <link rel="stylesheet" crossorigin href="./assets/help-.css">
</head>

<body class="p-8">

    <div class="max-w-3xl mx-auto bg-white p-8 md:p-10 rounded-xl shadow-2xl border border-gray-200">
        <h1 class="text-3xl font-extrabold text-indigo-600 mb-6 border-b pb-2">
            Graph Debugger : How To Use
        </h1>

        <p class="text-gray-700 mb-8">
            extract graph and meshes using these two functions in processing entry point after explosion graph is
            constructed.
            <!-- Use <pre> to maintain formatting and <code> to semantically mark it as code -->
        <pre class="bg-gray-800 text-white p-4 rounded-lg overflow-x-auto text-sm shadow-md">
<code class="language-python">
def save_explosion_txt(filename:str, assembly: LoadedAssembly, explosion_hierarchy:
                       dict[str, ExplosionGraph]):
    try:
        with open(filename, 'w') as file:
            explosion_hierarchy = compressed_explosion_hierarchy(explosion_hierarchy)
            hierarchy_view = ExplosionHierarchyView(explosion_hierarchy)  
            for sub_id, explosion_graph in explosion_hierarchy.items():
                component_ids = list(explosion_graph.blocking_graph.nodes)
                order = defaultdict(list)
                for node in explosion_graph.blocking_graph.nodes:
                    level = explosion_graph.blocking_graph.nodes[node]["level"]
                    order[level].append(node)
                max_level = max(order.keys()) if order else 0
                for level in range(max_level + 1):
                    if level not in order:
                        continue
                    removed_components = order[level]
                    removed_components.sort()
                    for ci, component in enumerate(removed_components):
                        isGrouped = explosion_graph.blocking_graph.nodes[component].get("grouped", False)
                        dir:Vec3D = explosion_graph.blocking_graph.nodes[component][REMOVAL_DIRECTION]
                        dirStr = ",".join(map(str, dir))
                        line = component + "," + str(level) + "," + dirStr 
                        parent = explosion_graph.critical_parents[component]
                        parentStr = "None"
                        if parent:
                            parentStr = parent
                        line = line + "," + parentStr
                        file.write(line + '\n')
    except IOError as e:
        print(f"error writing file: {e}")
        return

def dump_meshes(a: LoadedAssembly, dir: str):    
    for i, comp in enumerate(a.components):
        filename = str(dir) + "/" + comp.id + ".obj"
        try:
            comp.mesh.export(filename,"obj")
        except Exception as e:
            print(filename + " " + str(e))
</code>
</pre>
        </p>
        <div class="space-y-4 mb-8">
            In any order, load graph .txt file using the file button in load graph data area and load all .obj meshes in
            the Load 3D model area by multi-selecting all meshes.
        </div>
        <div class="space-y-4 mb-8">
            Example graph txt file for chat dbe221c9 are below.
            The columns are: name, disassembly order, direction, parent.
            direction is three numbers. not sure what disassembly order is exactly and currently unused in the ui.
            parent is simply the origin of the displacement for this part.
        </div>
        <pre class="bg-gray-800 text-white p-4 rounded-lg overflow-x-auto text-sm shadow-md">
4315607:1___3032___0,0,-1.0,0.0,0.0,YA00060530:1___1087___12
4315607:2___2986___1,0,1.0,0.0,0.0,YA00060530:2___3___13
YA00060535:1___2196___4,1,0.0082003865391016,0.722795307636261,-0.691013514995575,YA00060530:2___3___13
YA00060535:2___2171___5,1,-0.0082003865391016,-0.722795307636261,0.691013514995575,YA00060530:1___1087___12
A810060_ZX3:2___3405___10,2,1.0,0.0,0.0,YA00060530:2___3___13
YA00060530:1___1087___12,3,-1.0,0.0,0.0,A810060_ZX3:1___3418___9
YA00060530:2___3___13,3,1.0,0.0,0.0,YA00008952@@@1___2
A810060_ZX3:1___3418___9,4,-1.0,0.0,0.0,3035618:1___3181___11
YA00008952@@@0___3,5,-1.0,0.0,0.0,YA40039211___8
YA00008952@@@1___2,6,1.0,0.0,0.0,YA40039211___8
3069556:1___2907___6,7,-1.0,0.0,0.0,3035618:1___3181___11
3069556:2___2828___7,7,1.0,0.0,0.0,YA40039211___8
3035618:1___3181___11,8,-1.0,0.0,0.0,YA40039211___8
YA40039211___8,9,-1.0,0.0,0.0,None
</pre>
        <div class="mt-10 pt-6 border-t text-center text-sm text-gray-500">
            If you encounter issues, slack
        </div>
    </div>

</body>

</html>